@using NWebsec.Mvc.HttpHeaders.Csp
@{
    ViewBag.Title = "CSP";
}
<h2>CSP</h2>

<p>This web application contains loads of inline scripts. Still, we'd really want to enable CSP!</p>

<p id="firstScript">First inline script was blocked. :(</p>
<p id="secondScript">Second inline script was blocked. :(</p>


@section scripts
{
    @*@Html.CspScriptNonce()*@
    <script language="javascript" @Html.CspScriptNonce()>
        $("#firstScript").text("First inline script was run! :)");
    </script>

    <script language="javascript" @Html.CspScriptNonce()>
        $("#secondScript").text("Second inline script was run! :)");
    </script>

    @*Evil script injected by attacker*@
    @*<script language="javascript">
        alert("pwned at NDC!");
    </script>*@

}

@section secondNavbar
{
    <div class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-brand">CSP demos:</div>
            </div>
            <ul class="nav navbar-nav">
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
            </ul>
        </div>
    </div>
}
